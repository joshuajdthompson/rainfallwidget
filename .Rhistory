panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12, family = "Comic Sans MS"),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12, family = "Times New Roman"),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
install.packages("showtext")
library(showtext)
font_add_google("Palanquin", family = "special")
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12, family = "Palanquin"),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12, family = "special"),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
showtext_auto()
library(showtext)
font_add_google("Palanquin", family = "sans-serif")
font_add("Palanquin", "www/Palanquin-Regular.ttf")
font_add("Palanquin", "C:/Users/pwthom19/Documents/R/website_widget/www/Palanquin-Regular.ttf")
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12, family = "Palanquin"),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
font_add("Palanquin", "C:/Users/pwthom19/Documents/R/website_widget/www/Palanquin-Medium.ttf")
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
install.packages("plotly")
p
p <- ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
ggplotly(p)
plotly::ggplotly(p)
query_res
lubridate::now
lubridate::now()
lubridate::now()-hour(24)
lubridate::now()-lubridate::hour(24)
lubridate::now()-lubridate::hours(24)
query_res %>% filter(dateTime >  lubridate::now()-lubridate::hours(24)) %>% summarize(rain=as.numeric(precip_mm)/25.4)
query_res %>% filter(dateTime >  lubridate::now()-lubridate::hours(24)) %>% dplyr::summarize(rain=as.numeric(precip_mm)/25.4)
query_res %>% filter(dateTime >  lubridate::now()-lubridate::hours(24))
query_res
query_res %>% dplyr::filter(dateTime > lubridate::now()-lubridate::hours(24))
query_res %>% dplyr::filter(dateTime > lubridate::now()-lubridate::hours(24)) %>% dplyr::summarize(rain=sum(as.numeric(precip_mm)/25.4,na.rm = T))
query_res %>% dplyr::filter(dateTime > lubridate::now()-lubridate::hours(24)) %>% dplyr::summarize(rain=sum(as.numeric(precip_mm)/25.4,na.rm = T)) %>% pull(rain)
query_res %>% dplyr::filter(dateTime > lubridate::now()-lubridate::hours(24)) %>% dplyr::summarize(rain=sum(as.numeric(precip_mm)/25.4,na.rm = T)) %>% dplyr::pull(rain)
query_res %>% dplyr::mutate(date=ymd(dateTime))
query_res %>% dplyr::mutate(date=lubridate::ymd(dateTime))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::as_date(dateTime))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(precip_mm,na.rm=T))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(as.character(precip_mm)/25.4,na.rm=T))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(as.numeric(precip_mm)/25.4,na.rm=T))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(as.numeric(precip_mm)/25.4,na.rm=T)) %>% top_n(n=1)
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(as.numeric(precip_mm)/25.4,na.rm=T)) %>% dplyr::top_n(n=1)
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(as.numeric(precip_mm)/25.4,na.rm=T)) %>% dplyr::ungroup() %>% dplyr::top_n(n=1)
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(as.numeric(precip_mm)/25.4,na.rm=T)) %>% dplyr::filter(hr_precip == max(hr_precip))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(as.numeric(precip_mm)/25.4,na.rm=T)) %>% dplyr::pull(max(hr_precip))
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(as.numeric(precip_mm)/25.4,na.rm=T)) %>% dplyr::pull(hr_precip)
query_res %>% dplyr::mutate(date=lubridate::as_date(dateTime),
hour=lubridate::hour(dateTime)) %>%
dplyr::group_by(date,hour) %>%
dplyr::summarise(hr_precip = sum(as.numeric(precip_mm)/25.4,na.rm=T)) %>% dplyr::pull(hr_precip) %>% max()
lubridate::now()
lubridate::round_date(lubridate::now(),"5 mins")
lubridate::round_date(lubridate::now(),"5 mins")
lubridate::floor_date(lubridate::now(),"5 mins")
lubridate::floor_date(lubridate::now(),"5 mins")
d.now <- lubridate::floor_date(lubridate::now(),"5 mins")
d.72  <- d.now-lubridate::hours(72)
d.72
as_date(d.now)
lubridate::as_date(d.now)
lubridate::hms(d.now)
lubridate::as_hms(d.now)
sprintf("%02d:%02d:%02d", hour(d.now), minute(d.now), second(d.now))
sprintf("%02d:%02d:%02d", lubridate::hour(d.now), lubridate::minute(d.now), lubridate::second(d.now))
paste0(lubridate::as_date(d.now),"T",sprintf("%02d:%02d:%02d", lubridate::hour(d.now), lubridate::minute(d.now), lubridate::second(d.now)))
paste0(lubridate::as_date(d.72),"T",sprintf("%02d:%02d:%02d", lubridate::hour(d.72), lubridate::minute(d.72), lubridate::second(d.72)))
paste0("https://monitormywatershed.org/wofpy/rest/1_1/GetValues?location=envirodiy:BWPR-RIVA-01&variable=envirodiy:WEATHERtronics_6011_RainDepth&startDate=",paste0(lubridate::as_date(d.72),"T",sprintf("%02d:%02d:%02d", lubridate::hour(d.72), lubridate::minute(d.72), lubridate::second(d.72))),"&endDate=", paste0(lubridate::as_date(d.now),"T",sprintf("%02d:%02d:%02d", lubridate::hour(d.now), lubridate::minute(d.now), lubridate::second(d.now))))
xml_address <- paste0("https://monitormywatershed.org/wofpy/rest/1_1/GetValues?location=envirodiy:BWPR-RIVA-01&variable=envirodiy:WEATHERtronics_6011_RainDepth&startDate=",paste0(lubridate::as_date(d.72),"T",sprintf("%02d:%02d:%02d", lubridate::hour(d.72), lubridate::minute(d.72), lubridate::second(d.72))),"&endDate=", paste0(lubridate::as_date(d.now),"T",sprintf("%02d:%02d:%02d", lubridate::hour(d.now), lubridate::minute(d.now), lubridate::second(d.now))))
#xml_address <- "https://monitormywatershed.org/wofpy/rest/1_1/GetValues?location=envirodiy:BWPR-RIVA-01&variable=envirodiy:WEATHERtronics_6011_RainDepth&startDate=2023-02-28T09:00:00&endDate=2023-02-28T10:00"
doc <- xml2::read_xml(xml_address)
values <- xml2::xml_find_all(doc, "//d1:values")  # d1 is the default namespace
query_res <-
dplyr::tibble(
dateTimeUTC = values %>% xml2::xml_find_all("./d1:value") %>% xml2::xml_attr("dateTimeUTC"),
dateTime = values %>% xml2::xml_find_all("./d1:value") %>% xml2::xml_attr("dateTime"),
precip_mm = values %>% xml2::xml_find_all("./d1:value") %>% xml2::xml_text()
) %>%
dplyr::mutate(dateTimeUTC = lubridate::as_datetime(dateTimeUTC),
dateTime = lubridate::as_datetime(dateTime))
query_res
p <- ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
p
p <- ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + #ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
p
p.L <- plotly::ggplotly(p)
p.L
p
p <- ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`,fill=`Precipitation (in)`)) + #ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
p.L <- plotly::ggplotly(p)
p <- ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = as.numeric(precip_mm)/25.4),
aes(x=dateTime, y=`Precipitation (in)`)) + #ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
scale_colour_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
p.L <- plotly::ggplotly(p)
p.L
p <- ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = round(as.numeric(precip_mm)/25.4,2)),
aes(x=dateTime, y=`Precipitation (in)`)) + #ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("#0434a4")) +
scale_colour_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
p.L <- plotly::ggplotly(p)
p.L
p <- ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = round(as.numeric(precip_mm)/25.4,2)),
aes(x=dateTime, y=`Precipitation (in)`)) + #ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity",fill="#0434a4") +
#scale_fill_manual(values = c("#0434a4")) +
#scale_colour_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="black"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
p
p.L <- plotly::ggplotly(p)
p.L
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = round(as.numeric(precip_mm)/25.4,2)),
aes(x=dateTime, y=`Precipitation (in)`)) + #ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity",fill="#0434a4") +
#scale_fill_manual(values = c("#0434a4")) +
#scale_colour_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="#0434a4"),
strip.background = element_rect(fill="#0434a4"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = round(as.numeric(precip_mm)/25.4,2)),
aes(x=dateTime, y=`Precipitation (in)`)) + #ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity",fill="#0434a4") +
#scale_fill_manual(values = c("#0434a4")) +
#scale_colour_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="#0434a4"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
p <- ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = round(as.numeric(precip_mm)/25.4,2)),
aes(x=dateTime, y=`Precipitation (in)`)) + #ylim(0,5) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity",fill="#0434a4") +
#scale_fill_manual(values = c("#0434a4")) +
#scale_colour_manual(values = c("#0434a4")) +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="#0434a4"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="black",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
p.L <- plotly::ggplotly(p)
p.L
ggplot2::ggplot(query_res %>% dplyr::mutate(Title = "72-hr Rainfall Record at BWPR",
`Precipitation (in)` = round(as.numeric(precip_mm)/25.4,2)),
aes(x=dateTime, y=`Precipitation (in)`)) +
facet_wrap(~Title,ncol=1) +
geom_bar(stat="identity",fill="#0434a4") +
guides(fill=guide_legend("")) +
xlab("") +
theme(legend.position = "None",axis.text.x = element_text(angle = 0, vjust = 0, hjust=0.5,colour="black"),
strip.background = element_rect(fill="#0434a4"),
strip.text = element_text(colour = 'white',face="bold",size = 12),
panel.background = element_blank(),
panel.grid.major.x = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.grid.major.y = element_line(size = 0.5, linetype = 'solid',
colour = "lightgrey"),
panel.border=element_rect(colour="#0434a4",size=1,fill=NA),
axis.text.y=element_text(colour="black"),
legend.background = element_rect(colour = 'black', fill = 'white', linetype='solid'), legend.spacing.x = unit(0, "pt"),legend.margin=margin(t=-0.5,l=0.05,b=0.05,r=0.05, unit='cm'))
library(lubridate)
library(xml2)
library(tidyverse)
library(ggplot2)
library(plotly)
library(shiny)
runApp('R/website_widget/website_rainWidget.R')
total24
runApp('R/website_widget/website_rainWidget.R')
runApp('R/website_widget/website_rainWidget.R')
runApp('R/website_widget/website_rainWidget.R')
runApp('R/website_widget/website_rainWidget.R')
runApp('R/website_widget/website_rainWidget.R')
runApp('R/website_widget/website_rainWidget.R')
runApp('R/website_widget/website_rainWidget.R')
showtext_auto()
?showtext_auto()
library(shiny); runApp('R/website_widget/website_rainWidget.R')
library(shiny); runApp('R/website_widget/website_rainWidget.R')
runApp('R/website_widget/website_rainWidget.R')
